using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;

namespace 西洋棋__終
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }
        Button[,] but = new Button[8, 8];
        string[] chess = new string[6];
        string start;           //移動(不要刪錯!!!!!!!!!!!!)
        int a;                  //次數
        int b, c;
        int d, f;
        bool pass = false;        //輪流
        bool white = false;          //白棋國王
        bool black = false;         //黑棋國王
        private void Form1_Load(object sender, EventArgs e)
        {
            but[0, 0] = button1; but[0, 1] = button2; but[0, 2] = button3; but[0, 3] = button4; but[0, 4] = button5; but[0, 5] = button6; but[0, 6] = button7; but[0, 7] = button8;

            but[1, 0] = button9; but[1, 1] = button10; but[1, 2] = button11; but[1, 3] = button12; but[1, 4] = button13; but[1, 5] = button14; but[1, 6] = button15; but[1, 7] = button16;

            but[2, 0] = button17; but[2, 1] = button18; but[2, 2] = button19; but[2, 3] = button20; but[2, 4] = button21; but[2, 5] = button22; but[2, 6] = button23; but[2, 7] = button24;

            but[3, 0] = button25; but[3, 1] = button26; but[3, 2] = button27; but[3, 3] = button28; but[3, 4] = button29; but[3, 5] = button30; but[3, 6] = button31; but[3, 7] = button32;

            but[4, 0] = button33; but[4, 1] = button34; but[4, 2] = button35; but[4, 3] = button36; but[4, 4] = button37; but[4, 5] = button38; but[4, 6] = button39; but[4, 7] = button40;

            but[5, 0] = button41; but[5, 1] = button42; but[5, 2] = button43; but[5, 3] = button44; but[5, 4] = button45; but[5, 5] = button46; but[5, 6] = button47; but[5, 7] = button48;

            but[6, 0] = button49; but[6, 1] = button50; but[6, 2] = button51; but[6, 3] = button52; but[6, 4] = button53; but[6, 5] = button54; but[6, 6] = button55; but[6, 7] = button56;

            but[7, 0] = button57; but[7, 1] = button58; but[7, 2] = button59; but[7, 3] = button60; but[7, 4] = button61; but[7, 5] = button62; but[7, 6] = button63; but[7, 7] = button64;

            chess[0] = "國王";
            chess[1] = "皇后";
            chess[2] = "主教";
            chess[3] = "騎士";
            chess[4] = "塔樓";
            chess[5] = "士兵";
        }
        private void button1_Click_1(object sender, EventArgs e)
        {
            b = 0;                                      
            c = 0;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" )
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }                               
        }

        private void button2_Click(object sender, EventArgs e)
        {
            b = 0;
            c = 1;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button3_Click(object sender, EventArgs e)
        {
            b = 0;
            c = 2;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button4_Click(object sender, EventArgs e)
        {
            b = 0;
            c = 3;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button5_Click(object sender, EventArgs e)
        {
            b = 0;
            c = 4;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button6_Click(object sender, EventArgs e)
        {
            b = 0;
            c = 5;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button7_Click(object sender, EventArgs e)
        {
            b = 0;
            c = 6;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button8_Click(object sender, EventArgs e)
        {
            b = 0;
            c = 7;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button9_Click(object sender, EventArgs e)
        {
            b = 1;
            c = 0;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button10_Click(object sender, EventArgs e)
        {
            b = 1;
            c = 1;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button11_Click(object sender, EventArgs e)
        {
            b = 1;
            c = 2;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button12_Click(object sender, EventArgs e)
        {
            b = 1;
            c = 3;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button13_Click(object sender, EventArgs e)
        {
            b = 1;
            c = 4;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button14_Click(object sender, EventArgs e)
        {
            b = 1;
            c = 5;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button15_Click(object sender, EventArgs e)
        {
            b = 1;
            c = 6;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button16_Click(object sender, EventArgs e)
        {
            b = 1;
            c = 7;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button17_Click(object sender, EventArgs e)
        {
            b = 2;
            c = 0;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button18_Click(object sender, EventArgs e)
        {
            b = 2;
            c = 1;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button19_Click(object sender, EventArgs e)
        {
            b = 2;
            c = 2;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button20_Click(object sender, EventArgs e)
        {
            b = 2;
            c = 3;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button21_Click(object sender, EventArgs e)
        {
            b = 2;
            c = 4;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button22_Click(object sender, EventArgs e)
        {
            b = 2;
            c = 5;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button23_Click(object sender, EventArgs e)
        {
            b = 2;
            c = 6;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button24_Click(object sender, EventArgs e)
        {
            b = 2;
            c = 7;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button25_Click(object sender, EventArgs e)
        {
            b = 3;
            c = 0;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button26_Click(object sender, EventArgs e)
        {
            b = 3;
            c = 1;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button27_Click(object sender, EventArgs e)
        {
            b = 3;
            c = 2;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button28_Click(object sender, EventArgs e)
        {
            b = 3;
            c = 3;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button29_Click(object sender, EventArgs e)
        {
            b = 3;
            c = 4;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button30_Click(object sender, EventArgs e)
        {
            b = 3;
            c = 5;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button31_Click(object sender, EventArgs e)
        {
            b = 3;
            c = 6;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button32_Click(object sender, EventArgs e)
        {
            b = 3;
            c = 7;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button33_Click(object sender, EventArgs e)
        {
            b = 4;
            c = 0;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button34_Click(object sender, EventArgs e)
        {
            b = 4;
            c = 1;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button35_Click(object sender, EventArgs e)
        {
            b = 4;
            c = 2;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button36_Click(object sender, EventArgs e)
        {
            b = 4;
            c = 3;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button37_Click(object sender, EventArgs e)
        {
            b = 4;
            c = 4;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button38_Click(object sender, EventArgs e)
        {
            b = 4;
            c = 5;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button39_Click(object sender, EventArgs e)
        {
            b = 4;
            c = 6;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button40_Click(object sender, EventArgs e)
        {
            b = 4;
            c = 7;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button41_Click(object sender, EventArgs e)
        {
            b = 5;
            c = 0;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button42_Click(object sender, EventArgs e)
        {
            b = 5;
            c = 1;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button43_Click(object sender, EventArgs e)
        {
            b = 5;
            c = 2;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button44_Click(object sender, EventArgs e)
        {
            b = 5;
            c = 3;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button45_Click(object sender, EventArgs e)
        {
            b = 5;
            c = 4;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button46_Click(object sender, EventArgs e)
        {
            b = 5;
            c = 5;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button47_Click(object sender, EventArgs e)
        {
            b = 5;
            c = 6;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button48_Click(object sender, EventArgs e)
        {
            b = 5;
            c = 7;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button49_Click(object sender, EventArgs e)
        {
            b = 6;
            c = 0;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button50_Click(object sender, EventArgs e)
        {
            b = 6;
            c = 1;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button51_Click(object sender, EventArgs e)
        {
            b = 6;
            c = 2;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button52_Click(object sender, EventArgs e)
        {
            b = 6;
            c = 3;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button53_Click(object sender, EventArgs e)
        {
            b = 6;
            c = 4;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button54_Click(object sender, EventArgs e)
        {
            b = 6;
            c = 5;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button55_Click(object sender, EventArgs e)
        {
            b = 6;
            c = 6;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button56_Click(object sender, EventArgs e)
        {
            b = 6;
            c = 7;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button57_Click(object sender, EventArgs e)
        {
            b = 7;
            c = 0;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button58_Click(object sender, EventArgs e)
        {
            b = 7;
            c = 1;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button59_Click(object sender, EventArgs e)
        {
            b = 7;
            c = 2;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button60_Click(object sender, EventArgs e)
        {
            b = 7;
            c = 3;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button61_Click(object sender, EventArgs e)
        {
            b = 7;
            c = 4;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button62_Click(object sender, EventArgs e)
        {
            b = 7;
            c = 5;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button63_Click(object sender, EventArgs e)
        {
            b = 7;
            c = 6;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button64_Click(object sender, EventArgs e)
        {
            b = 7;
            c = 7;
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int i = 0; i < 8; i++)                                          //重製(整面)
            {
                for (int j = 0; j < 8; j++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)                                          //還原
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            if (pass == false)                                                      //回合 白
            {
                if (a == 0)                                                             //按第一次
                {
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {                                                                //******
                            if (but[j, i].ForeColor == Color.White && but[j, i].Enabled == false && but[j, i].Text != "" && j != b && i != c)    //按下時 自己以外的白棋顯示
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  白 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[1])                                            //按皇后  白 ***************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教白************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //友方(白)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //敵方(黑)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士白****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.White && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                            //按塔樓白****************************************************
                    {
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)      //友方(白)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)     //敵方(黑)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵白************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b - 1, c - 1].Text != "" && but[b - 1, c - 1].ForeColor == Color.Black)         //左前
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)
                        {
                            if (but[b - 1, c + 1].Text != "" && but[b - 1, c + 1].ForeColor == Color.Black)     //右前
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b - 1, c].Text == "")                                               //前
                        {
                            if (b == 6 && but[b - 2, c].Text == "")
                            {
                                but[b - 2, c].Enabled = true;
                            }
                            but[b - 1, c].Enabled = true;
                        }
                    }
                    but[b, c].Enabled = true;
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else                                                                                  //按第二次
                {
                    {
                        if (d == b && f == c)                                                 //按一樣的
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    but[j, i].Enabled = false;
                                }
                            }
                            for (int j = 0; j < 8; j++)
                            {
                                for (int i = 0; i < 8; i++)
                                {
                                    for (int h = 0; h < 5; h++)
                                    {
                                        if (but[j, i].Text != "" && but[j, i].ForeColor == Color.White)
                                        {
                                            but[j, i].Enabled = true;
                                        }
                                    }
                                }
                            }
                            start = "";
                            a = 0;
                            b = 0;
                            d = 0;
                            f = 0;
                        }
                        else                            //按不一樣的
                        {
                            a = 0;
                            but[b, c].Text = start;
                            but[d, f].Text = "";
                            but[b, c].ForeColor = Color.White;
                            if (but[b, c].Text == chess[5] && b == 0)           //小兵升變 (白)
                            {
                                button65.Enabled = false;
                                gB1.Visible = true;
                            }
                        }
                    }
                }
            }
            else                                                                               //回合 黑
            {
                if (a == 0)                                                                  //按第一次
                {
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    if (but[b, c].Text == chess[0])                                     //按國王  黑 ***************************************************************
                    {
                        if (b < 7)                     //不在最上面
                        {
                            but[b + 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)                     //不在最下面
                        {
                            but[b - 1, c].Enabled = true;
                            if (c < 7)                     //不在最右邊
                            {
                                but[b - 1, c + 1].Enabled = true;
                            }
                            if (c > 0)                     //不在最左邊
                            {
                                but[b - 1, c - 1].Enabled = true;
                            }
                        }
                        if (c < 7)                     //不在最右邊
                        {
                            but[b, c + 1].Enabled = true;
                        }
                        if (c > 0)                     //不在最左邊
                        {
                            but[b, c - 1].Enabled = true;
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    if (but[b, c].Text == chess[1])                                            //按皇后  黑 ************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8)                                                                    //上     
                                {
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c].Enabled = true;
                                    if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1)                                                                    //下
                                {
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c].Enabled = true;
                                    if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c - jj > -1)                                                                    //左
                                {
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c - jj].Enabled = true;
                                    if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = d; i < 8; i++)
                            {
                                jj++;
                                if (c + jj < 8)                                                                    //左
                                {
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b, c + jj].Enabled = true;
                                    if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[2])                                            //按主教黑************************************************************
                    {
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c + jj < 8)                                                                //右上     
                                {
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c + jj].Enabled = true;
                                    if (but[b + jj, c + jj].Text != "" && but[b + jj, c + jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b + jj < 8 && c - jj > -1)                                                                //左上     
                                {
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b + jj, c - jj].Enabled = true;
                                    if (but[b + jj, c - jj].Text != "" && but[b + jj, c - jj].ForeColor == Color.White)     //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c - jj > -1)                       //左下    
                                {
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c - jj].Enabled = true;
                                    if (but[b - jj, c - jj].Text != "" && but[b - jj, c - jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                        {
                            int jj = 0;
                            for (int i = 0; i < 8; i++)
                            {
                                jj++;
                                if (b - jj > -1 && c + jj < 8)                        //右下    
                                {
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.Black)      //友方(黑)
                                    {
                                        break;
                                    }
                                    but[b - jj, c + jj].Enabled = true;
                                    if (but[b - jj, c + jj].Text != "" && but[b - jj, c + jj].ForeColor == Color.White)      //敵方(白)
                                    {
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[3])                                //按騎士黑****************************************************
                    {
                        if (b < 6)          		//(b+2)
                        {
                            if (c < 7)              //(+2,+1)
                            {
                                but[b + 2, c + 1].Enabled = true;
                            }
                            if (c > 0)              //(+2,-1)
                            {
                                but[b + 2, c - 1].Enabled = true;
                            }
                        }
                        if (b < 7)          	    //(b+1)
                        {
                            if (c < 6)              //(+1,+2)    
                            {
                                but[b + 1, c + 2].Enabled = true;
                            }
                            if (c > 1)             //(+1,-2)    
                            {
                                but[b + 1, c - 2].Enabled = true;
                            }
                        }
                        if (b > 1)               	 //(b-2)
                        {
                            if (c < 7)              //(-2,+1)       
                            {
                                but[b - 2, c + 1].Enabled = true;
                            }
                            if (c > 0)             //(-2,-1)    
                            {
                                but[b - 2, c - 1].Enabled = true;
                            }
                        }
                        if (b > 0)         		  //(b-1)
                        {
                            if (c < 6)            //(-1,+2)    
                            {
                                but[b - 1, c + 2].Enabled = true;
                            }
                            if (c > 1)            //(-1,-2)   
                            {
                                but[b - 1, c - 2].Enabled = true;
                            }
                        }
                        for (int i = 0; i < 8; i++)
                        {
                            for (int j = 0; j < 8; j++)
                            {
                                if (but[i, j].ForeColor == Color.Black && but[i, j].Text != "")
                                {
                                    but[i, j].Enabled = false;
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[4])                                              //按 塔樓黑************************************************************
                    {
                        if (but[b, c].Text == chess[4])                                            //按塔樓  黑
                        {
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b + jj < 8)                                                                    //上     
                                    {
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b + jj, c].Enabled = true;
                                        if (but[b + jj, c].Text != "" && but[b + jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (b - jj > -1)                                                                    //下
                                    {
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b - jj, c].Enabled = true;
                                        if (but[b - jj, c].Text != "" && but[b - jj, c].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c - jj > -1)                                                                    //左
                                    {
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c - jj].Enabled = true;
                                        if (but[b, c - jj].Text != "" && but[b, c - jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            {
                                int jj = 0;
                                for (int i = d; i < 8; i++)
                                {
                                    jj++;
                                    if (c + jj < 8)                                                                    //左
                                    {
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.Black)      //友方(黑)
                                        {
                                            break;
                                        }
                                        but[b, c + jj].Enabled = true;
                                        if (but[b, c + jj].Text != "" && but[b, c + jj].ForeColor == Color.White)     //敵方(白)
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (but[b, c].Text == chess[5])                                            //按士兵   黑************************************************************
                    {
                        if (c != 0)
                        {
                            if (but[b + 1, c - 1].Text != "" && but[b + 1, c - 1].ForeColor == Color.White)         //左前
                            {
                                but[b + 1, c - 1].Enabled = true;
                            }
                        }
                        if (c != 7)                                                                          //右
                        {
                            if (but[b + 1, c + 1].Text != "" && but[b + 1, c + 1].ForeColor == Color.White)     //右前
                            {
                                but[b + 1, c + 1].Enabled = true;
                            }
                        }
                        if (but[b + 1, c].Text == "")                                               //前
                        {
                            if (b == 1 && but[b + 2, c].Text == "")
                            {
                                but[b + 2, c].Enabled = true;
                            }
                            but[b + 1, c].Enabled = true;
                        }
                    }
                    //////////////////////////////////////////////
                    //////////////////////////////////////////////
                    for (int i = 0; i < 8; i++)                                          //顯示(白)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                            {
                                but[j, i].BackColor = Color.White;
                            }
                        }
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            if (but[i, j].Text != "" && but[i, j].ForeColor == Color.White && but[i, j].Enabled == true)
                            {
                                but[i, j].ForeColor = Color.Black;
                            }
                        }
                    }
                    but[b, c].Enabled = true;
                    a++;
                    start = but[b, c].Text;
                    d = b;
                    f = c;
                }
                else            //按第二次
                {
                    if (d == b && f == c)       //按一樣的
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                but[j, i].Enabled = false;
                            }
                        }
                        for (int j = 0; j < 8; j++)
                        {
                            for (int i = 0; i < 8; i++)
                            {
                                for (int h = 0; h < 5; h++)
                                {
                                    if (but[j, i].Text != "" && but[j, i].ForeColor == Color.Black)
                                    {
                                        but[j, i].Enabled = true;
                                    }
                                }
                            }
                        }
                        start = "";
                        a = 0;
                        b = -1;
                        d = -1;
                        f = -1;
                    }
                    else                            //按不一樣的
                    {
                        a = 0;
                        but[b, c].Text = start;
                        but[d, f].Text = "";
                        but[b, c].ForeColor = Color.Black;
                        if (but[b, c].Text == chess[5] && b == 7)           //小兵升變 (黑)
                        {
                            button65.Enabled = false;
                            gB1.Visible = true;
                        }
                    }
                }
            }
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].ForeColor == Color.White && but[j, i].Text != "" && but[j, i].Enabled == false)
                    {
                        but[j, i].BackColor = Color.White;
                    }
                }
            }        
        }

        private void button65_Click(object sender, EventArgs e)
        {
            for (int j = 0; j < 8; j++)
            {
                for (int i = 0; i < 8; i++)
                {
                    if (but[j, i].BackColor == Color.White)
                    {
                        but[j, i].ForeColor = Color.White;
                    }
                }
            }
            for (int j = 0; j < 8; j++)                                         //pass
            {
                for (int i = 0; i < 8; i++)
                {
                    but[j, i].Enabled = false;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.DimGray;
                }
            }
            for (int h = 1; h < 8; h += 2)
            {
                for (int hh = 0; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            for (int h = 0; h < 8; h += 2)
            {
                for (int hh = 1; hh < 8; hh += 2)
                {
                    but[h, hh].BackColor = Color.Gainsboro;
                }
            }
            pass = !pass;
            if (pass == false)
            {
                label21.Text = "白棋回合";
                label21.BackColor = Color.White;
                for (int j = 0; j < 8; j++)
                {
                    for (int i = 0; i < 8; i++)
                    {
                        if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                        {
                            but[j, i].Enabled = true;
                        }
                    }
                }
            }
            else
            {
                label21.Text = "黑棋回合";
                label21.BackColor = Color.Gray;
                for (int j = 0; j < 8; j++)
                {
                    for (int i = 0; i < 8; i++)
                    {
                        if (but[j, i].ForeColor == Color.Black && but[j, i].Text != "")
                        {
                            but[j, i].Enabled = true;
                        }
                    }
                }
                for (int j = 0; j < 8; j++)
                {
                    for (int i = 0; i < 8; i++)
                    {
                        if (but[j, i].ForeColor == Color.White && but[j, i].Text != "")
                        {
                            but[j, i].BackColor = Color.White;
                        }
                    }
                }
            }
            {
                for (int j = 0; j < 8; j++)                                         //偵測國王 (白)
                {
                    for (int i = 0; i < 8; i++)
                    {
                        if (but[j, i].Text == chess[0] && but[j, i].ForeColor == Color.White)
                        {
                            white = true;                                       //活著                              
                        }
                    }
                }
                if (white == false)                                                 //國王 (白) 死亡
                {
                    MessageBox.Show("黑棋勝利");
                    for (int i = 0; i < 8; i++)                                          //重製(整面)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            button65.Text = "黑棋勝利";
                            label21.Text = "黑棋勝利";
                            label21.BackColor = Color.Gray;
                            for (int jj = 0; jj < 8; jj++)                                         //END
                            {
                                for (int ii = 0; ii < 8; ii++)
                                {
                                    but[jj, ii].Enabled = false;
                                }
                            }
                        }
                    }
                }
                else                                                                //國王 (白)存活
                {
                    white = false;
                }
                for (int j = 0; j < 8; j++)                                         //偵測國王 (白)
                {
                    for (int i = 0; i < 8; i++)
                    {
                        if (but[j, i].Text == chess[0] && but[j, i].ForeColor == Color.Black)
                        {
                            black = true;                                       //活著                              
                        }
                    }
                }
                if (black == false)                                                 //國王 (黑) 死亡
                {
                    MessageBox.Show("白棋勝利");
                    for (int i = 0; i < 8; i++)                                          //重製(整面)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            button65.Text = "白棋勝利";
                            label21.Text = "白棋勝利";
                            label21.BackColor = Color.White;
                            for (int jj = 0; jj < 8; jj++)                                         //END
                            {
                                for (int ii = 0; ii < 8; ii++)
                                {
                                    but[jj, ii].Enabled = false;
                                }
                            }
                        }
                    }
                }
                else                                                                //國王 (黑)存活
                {
                    black = false;
                }
            }
            a = 0;
            b = -1;
            c = -1;
            d = -1;
            f = -1;
        }

        private void bt1_Click(object sender, EventArgs e)
        {
            but[b, c].Text = bt1.Text;
            button65.Enabled = true;
            gB1.Visible = false;
        }

        private void bt2_Click(object sender, EventArgs e)
        {
            but[b, c].Text = bt2.Text;
            button65.Enabled = true;
            gB1.Visible = false;
        }

        private void bt3_Click(object sender, EventArgs e)
        {
            but[b, c].Text = bt3.Text;
            button65.Enabled = true;
            gB1.Visible = false;
        }

        private void bt4_Click(object sender, EventArgs e)
        {
            but[b, c].Text = bt4.Text;
            button65.Enabled = true;
            gB1.Visible = false;
        }
    }
}
